(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{384:function(t,a,n){"use strict";n.r(a);var s=n(33),e=Object(s.a)({},(function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"gain-volume"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#gain-volume"}},[t._v("#")]),t._v(" Gain / Volume")]),t._v(" "),n("p",[t._v("You might be looking for a way to change the main volume or the volume of individual sound sources.\nThis can be done using gain.")]),t._v(" "),n("h2",{attrs:{id:"gain-is-not-volume"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#gain-is-not-volume"}},[t._v("#")]),t._v(" Gain is not Volume")]),t._v(" "),n("p",[t._v("In short: "),n("a",{attrs:{href:"https://www.musicianonamission.com/gain-vs-volume/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Gain controls how loud something is before it gets processed"),n("OutboundLink")],1),t._v(".")]),t._v(" "),n("p",[t._v("In order to understand what that means, we need to understand how web audio processes sound:")]),t._v(" "),n("h2",{attrs:{id:"connecting-nodes"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#connecting-nodes"}},[t._v("#")]),t._v(" Connecting Nodes")]),t._v(" "),n("p",[t._v("In web audio you connect nodes to other nodes until you finally end up at the AudioContext destination.")]),t._v(" "),n("p",[t._v("A simple connection flow without positional audio and without volume/gain control might look like this:")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("AudioBufferSourceNode -> AudioContext.destination\n")])])]),n("p",[t._v("Once you add positional audio, it might look like this:")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("(AudioBufferSourceNode -> PannerNode) -> AudioContext.destination\n")])])]),n("p",[t._v("The brackets represent the nodes within the "),n("RouterLink",{attrs:{to:"/api/classes/SoundSource.html"}},[t._v("SoundSource")]),t._v(", so you have one context, but multiple PannerNodes connected to this context.")],1),t._v(" "),n("p",[t._v('Now, in order to control the global "volume", we need to insert a GainNode right before the AudioContext:')]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("AudioBufferSourceNode -> GainNode -> AudioContext.destination\n")])])]),n("p",[t._v("If we have positional audio, we might have a GainNode after the PannerNode as well:")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("(AudioBufferSourceNode -> PannerNode -> GainNode) -> GainNode -> AudioContext.destination\n")])])]),n("p",[t._v('In this scenario, you can change the gain of the positioned sound as well as the overall "main volume".')]),t._v(" "),n("h2",{attrs:{id:"adding-global-main-volume"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#adding-global-main-volume"}},[t._v("#")]),t._v(" Adding Global/Main Volume")]),t._v(" "),n("p",[t._v('As we learned above, we need to introduce a GainNode in order to configure the global "volume".')]),t._v(" "),n("h3",{attrs:{id:"without-positional-audio"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#without-positional-audio"}},[t._v("#")]),t._v(" Without Positional Audio")]),t._v(" "),n("div",{staticClass:"language-typescript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-typescript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" SoundPlayer "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"sounts"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" mainVolume "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" audioContext"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createGain")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// connect main volume to audioContext.destination")]),t._v("\nmainVolume"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("connect")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("audioContext"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("destination"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Connect the player to mainVolume instead of audioContext.destination!")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" player "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SoundPlayer")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mainVolume"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Set the gain value (0-1):")]),t._v("\nmainVolume"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gain"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h3",{attrs:{id:"with-positional-audio"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#with-positional-audio"}},[t._v("#")]),t._v(" With Positional Audio")]),t._v(" "),n("div",{staticClass:"language-typescript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-typescript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" SoundSource "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"sounts"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" mainVolume "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" audioContext"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createGain")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// connect main volume to audioContext.destination")]),t._v("\nmainVolume"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("connect")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("audioContext"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("destination"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Connect the sound source to mainVolume instead of audioContext.destination!")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Also pass a gain property to the sound source")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" source "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SoundSource")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mainVolume"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" gain"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.75")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Later you can change the gain:")]),t._v("\nsource"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("setGain")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("By passing in a gain value as option to the "),n("RouterLink",{attrs:{to:"/api/classes/SoundSource.html"}},[t._v("SoundSource")]),t._v(" constructor, a gain node will automatically be added to the source.")],1),t._v(" "),n("p",[n("strong",[t._v("Note")]),t._v(", that you can't call setGain unless you passed a gain value in the options parameter.")]),t._v(" "),n("h3",{attrs:{id:"summary"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#summary"}},[t._v("#")]),t._v(" Summary")]),t._v(" "),n("p",[t._v("As you can see, it's quite easy to configure GainNodes. You can even have different GainNodes for different sources and players. For example one for main volume, one music, one for all sound effects and one for each sound source individually.")])])}),[],!1,null,null,null);a.default=e.exports}}]);